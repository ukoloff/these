% !TeX root = ..
\section{Введение}\label{sec:intro}
Обобщенная задача коммивояжера (GTSP) --
это хорошо известная задача комбинаторной оптимизации,
представленная в основополагающей статье \cite{SKGS1969}
Сриваставы и др. и привлекшая внимание многих исследователей
(см. обзор в~\cite{GutinPunnen2007}).

В GTSP для данного взвешенного орграфа
$ G = (V, E, c) $
и разбиения $ V_1 \cup \ldots \cup V_m $ набора узлов $ V $
на непустые взаимно непересекающиеся кластеры требуется найти замкнутый тур с минимальной стоимостью $ T $,
который посещает каждый кластер $ V_i $ ровно один раз.

В этой статье мы рассматриваем обобщенную задачу коммивояжера
с ограничением предшествования (PCGTSP),
в которой кластеры следует посещать в соответствии с некоторым заданным частичным порядком.
Эта расширенная версия GTSP имеет множество практический применений, включая
\begin{itemize}
	\item
	оптимизация траектории инструмента для станков с числовым программным управлением (ЧПУ)
	\cite{CASTELINO2003173}
	\item
	минимизация времени {\it холостого хода} при раскрое листового металла
	\cite{Petunin2018, Makarovskikh20181171}
	\item
	координатно-измерительное оборудование
	\cite{SALMAN2016138}
	\item
	оптимизация траектории при многоствольном бурении
	\cite{DEWIL2019}.
\end{itemize}

\subsection{Связанные работы}
GTSP - это расширение классической задачи коммивояжера (TSP).
Следовательно, если оценивать размер задачи количеством кластеров
$ m $,
задача становится NP-сложной даже на евклидовой плоскости \cite{Papa77}.
С другой стороны,
хорошо известная схема динамического программирования Хелда и Карпа~\cite{HeldKarp1962},
адаптированная к GTSP,
имеет временную сложность
$ O (n ^ 3m ^ 2 \cdot 2 ^ m) $,
то есть этот алгоритм принадлежит FPT,
будучи параметризован количеством кластеров.
Следовательно,
оптимальное решение
GTSP может быть найдено за полиномиальное время при условии
$ m = O (\log n) $.

Обзор литературы показывает,
что алгоритмическое проектирование GTSP развивалось по нескольким направлениям.

Первый подход основан на сведении исходной задачи к некоторой задаче асимметричной TSP,
после чего этот вспомогательный экземпляр может быть решен с помощью алгоритмов,
разработанного для ATSP
(\cite{LaporteSemet1999, NoonBean1993}).
Несмотря на математическую элегантность,
этот подход страдает несколькими недостатками:
\begin{enumerate}
\item
полученные экземпляры ATSP устроены довольно необычно,
что затрудняет их решение даже для современных решателей MIP,
таких как Gurobi и CPLEX.
\item
близкие к оптимальным решения задачи ATSP
могут соответствовать недопустимым решениям исходной задачи
\cite{KaraGut2012}.
\end{enumerate}

Другой подход связан с разработкой точных алгоритмов для частных случаев
и алгоритмов аппроксимации с теоретическими гарантиями производительности.
Среди них есть алгоритмы ветвей и границ и ветвей и разрезов
(см., например, \cite{FishGonToth1997, Yuan2020})
и приближенные схемы полиномиального времени (PTAS)
для некоторых специальных случаев
\cite{FerGriSit2006, KhN-PSIM2017}.

Наконец,
третий подход заключается в разработке
различных эвристик и метаэвристик.
Так, Г.~Гутин и Д.~Карапетян \cite{Gutin-2010}
предложили эффективный меметический алгоритм,
в \cite{Helsgaun-2015} знаменитый эвристический решатель
Лина-Кернигана-Хельсгауна был расширен до GTSP,
а в \cite{SMITH20171} была разработана мощная метаэвристика
Adaptive Large Neighborhood Search (ALNS),
которая на сегодняшний день является наиболее эффективной.

К сожалению, в случае PCGTSP
алгоритмические результаты все еще остаются довольно малочисленными.
Насколько нам известно, в открытых источниках доступны только
\begin{enumerate}
	\item
	эффективные алгоритмы для специальных ограничений предшествования типа Баласа
	\cite {Balas-Sim2001, ChenKhKh2016, CKK-IFAC2016}
	и ограничения предшествования, приводящие к квази- и псевдопирамидальным оптимальным обходам
	\cite{KhN-AMAI-2020}
	\item
	общие идеи о специализированном (PCGTSP) алгоритме ветвей и границ
	\cite{SALMAN2020163}
	\item
	недавняя эвристика PCGLNS, предложенная авторами
	\cite{KKP-optima2020}
	как расширение результатов
	\cite{SMITH20171}.
\end{enumerate}

В этой статье мы пытаемся восполнить этот пробел.

\subsection{Новизна данной работы}
\begin{itemize}
	\item
	расширяя идею, предложенную в \cite{SALMAN2020163},
	мы разрабатываем и реализуем первый специализированный алгоритм для PCGTSP
	\item
	расширяя классический подход к ветвлению \cite{MorinMarsten1976},
	мы реализуем схему динамического программирования Хелда и Карпа,
	дополненную оригинальной ограничивающей стратегией
	\item
	проведенные численные эксперименты показывают,
  что производительность предложенных алгоритмов
  сравнима как в смысле скорости, так и точности получаемых решений
  с современным решателем Gurobi,
  использующим лучшую в настоящее время MILP-модель
  и стартовое решение MIP

\end{itemize}
